(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{201:function(e,t,n){var r=n(202);"string"==typeof r&&(r=[[e.i,r,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n(7)(r,o);r.locals&&(e.exports=r.locals)},202:function(e,t,n){(e.exports=n(6)(!1)).push([e.i,".noselect {\n  -webkit-tap-highlight-color: transparent;\n  \n  -webkit-user-select: none;\n     -moz-user-select: none;\n      -ms-user-select: none;\n          user-select: none;\n}\n",""])},206:function(e,t,n){"use strict";n.r(t);var r=n(47),o=2.39996323,i=function(e,t){var n=Math.sqrt(e),r=e*t;return{x:n*Math.cos(r),y:n*Math.sin(r)}},a=function(e){return--e*e*e+1};function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t){return!t||"object"!==s(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var h=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),u(this,c(t).call(this,{uniforms:{texture:{value:null},resolution:{value:new r.n},direction:{value:new r.n}},vertexShader:"\n        varying vec2 vUv;\n\n        void main() {\n          vUv = uv;\n          gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n        }\n      ",fragmentShader:"\n        // gaussian kernel\n        // Ïƒ = 1, [ 0.06136, 0.24477, 0.38774, 0.24477, 0.06136 ]\n\n        varying vec2 vUv;\n\n        uniform sampler2D texture;\n        uniform vec2 resolution;\n        uniform vec2 direction;\n\n        void main() {\n          gl_FragColor = ((texture2D(texture, vUv + (direction * resolution *  2.0)) * 0.06136) + \n                          (texture2D(texture, vUv + (direction * resolution *  1.0)) * 0.24477) +\n                          (texture2D(texture, vUv + (direction * resolution *  0.0)) * 0.38774) + \n                          (texture2D(texture, vUv + (direction * resolution * -1.0)) * 0.24477) + \n                          (texture2D(texture, vUv + (direction * resolution * -2.0)) * 0.06136));\n        }\n      "}))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&l(e,t)}(t,r["k"]),t}();function f(e){return(f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function p(e,t){return!t||"object"!==f(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function m(e){return(m=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function v(e,t){return(v=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var d=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),p(this,m(t).call(this,{blending:r.a,transparent:!0,uniforms:{textures:{value:null}},vertexShader:"\n        varying vec2 vUv;\n\n        void main() {\n          vUv = uv;\n          gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n        }\n      ",fragmentShader:"\n        varying vec2 vUv;\n\n        uniform sampler2D textures[5];\n\n        void main() {\n          gl_FragColor = (texture2D(textures[0], vUv) +\n                          texture2D(textures[1], vUv) +\n                          texture2D(textures[2], vUv) +\n                          texture2D(textures[3], vUv) +\n                          texture2D(textures[4], vUv));\n        }\n      "}))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&v(e,t)}(t,r["k"]),t}();function y(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var b=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.quad=new r.e(new r.i(1,1)),this.camera=new r.g(-.5,.5,.5,-.5,0,-1),this.scene=new r.j,this.scene.add(this.quad),this.mipmap=[],this.mipmap.push({x:null,y:null});for(var t=256;t>8;t/=2)this.mipmap.push({x:new r.p(t,t),y:new r.p(t,t)});this.blurShader=new h,this.compositeShader=new d,this.compositeShader.uniforms.textures.value=this.mipmap.slice(1).map(function(e){return e.y.texture})}var t,n,o;return t=e,(n=[{key:"render",value:function(e,t){this.quad.material=this.blurShader,this.mipmap[0].y=t;for(var n=1;n<this.mipmap.length;n++)this.blurShader.uniforms.resolution.value.x=1/this.mipmap[n].x.width,this.blurShader.uniforms.resolution.value.y=1/this.mipmap[n].x.height,this.blurShader.uniforms.texture.value=this.mipmap[n-1].y.texture,this.blurShader.uniforms.direction.value.x=1,this.blurShader.uniforms.direction.value.y=0,e.render(this.scene,this.camera,this.mipmap[n].x,!0),this.blurShader.uniforms.texture.value=this.mipmap[n].x.texture,this.blurShader.uniforms.direction.value.x=0,this.blurShader.uniforms.direction.value.y=1,e.render(this.scene,this.camera,this.mipmap[n].y,!0);this.quad.material=this.compositeShader,e.render(this.scene,this.camera,t,!0)}}])&&y(t.prototype,n),o&&y(t,o),e}();function w(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var x=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.scene=t,this.camera=new r.h(45,1,.1,1e3),this.bloom=new b,this.postprocessing=new r.p;var n=new r.e(new r.i(1,1),new r.f({transparent:!0,map:this.postprocessing.texture}));this.compositeCamera=new r.g(-.5,.5,.5,-.5,0,-1),this.layer1=new r.j,this.layer1.add(n),this.layer2=new r.j}var t,n,o;return t=e,(n=[{key:"setSize",value:function(e,t){this.postprocessing.setSize(e,t)}},{key:"setBackgroundColor",value:function(e){this.layer1.background=new r.d(e)}},{key:"addObject",value:function(e){this.layer2.add(e)}},{key:"fitBoundingBox",value:function(e){var t=new r.o,n=new r.o;e.getCenter(t),e.getSize(n);var o=this.camera.fov*Math.PI/180;this.camera.position.x=t.x,this.camera.position.y=t.y,this.camera.position.z=e.max.z+1.2*n.y/2/Math.tan(o/2)}},{key:"render",value:function(e){e.render(this.scene,this.camera,this.postprocessing,!0),this.bloom.render(e,this.postprocessing),e.render(this.layer1,this.compositeCamera),e.render(this.layer2,this.compositeCamera)}}])&&w(t.prototype,n),o&&w(t,o),e}(),g=function(e,t,n){return Math.min(Math.max(e,t),n)},S=function(e){return e.reduce(function(e,t){return e+t},0)/e.length},O=function(e){return Math.sqrt(function(e){var t=S(e);return S(e.map(function(e){return Math.pow(e-t,2)}))}(e))};function j(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var k={min:.6,max:.7},_={min:.2,max:.6},E=[6089910,16089926,15351909],C={duration:.9,delay:function(e){return.04*e}},P=function(){function e(t,n){var s=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.scene=n,this.light=new r.b(16777215),this.scene.add(this.light),this.spheres=[];var u=t.map(function(e){return e.distance}),c=S(u),l=Math.max(O(u),1e-4),h=t.map(function(e){return e.speed}),f=S(h),p=Math.max(O(h),1e-4);t.forEach(function(e,t){var n=g(e.distance-c,-l,l),a=g(e.speed-f,-p,p),u=k.min+(n+l)/(2*l)*(k.max-k.min),h=_.min+(a+p)/(2*p)*(_.max-_.min),m=i(t,o),v=E[e.type],d=new r.e(new r.l(u,64),new r.f({transparent:!0,opacity:0,color:v}));d.position.set(m.x,m.y,0),d.userData={opacity:h},s.spheres.push(d),s.scene.add(d)}),this.boundingBox=(new r.c).setFromObject(this.scene),this.spheres.forEach(function(e){return e.scale.set(.1,.1,.1)}),this.start=new Date,this.animation=setInterval(function(){var e=(new Date-s.start)/1e3;s.spheres.forEach(function(t,n){var r=g((e-C.delay(n))/C.duration,0,1),o=a(r);t.material.opacity=t.userData.opacity*o,t.scale.set(.1+.9*o,.1+.9*o,.1+.9*o)})},15.625)}var t,n,s;return t=e,(n=[{key:"teardown",value:function(){var e=this;this.scene.remove(this.light),this.spheres.forEach(function(t){e.scene.remove(t)}),clearInterval(this.animation)}}])&&j(t.prototype,n),s&&j(t,s),e}(),U=n(0),L=n.n(U);var D=function e(t,n){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.anchor=null,t.addEventListener("mousedown",function(e){1==e.buttons&&(r.anchor={x:e.clientX,y:e.clientY})}),document.addEventListener("mousemove",function(e){if(1==e.buttons&&r.anchor){var t={x:e.clientX,y:e.clientY};n({x:t.x-r.anchor.x,y:t.y-r.anchor.y}),r.anchor=t}}),document.addEventListener("mouseup",function(e){r.anchor=null}),t.addEventListener("touchstart",function(e){r.anchor={x:e.touches[0].clientX,y:e.touches[0].clientY}}),t.addEventListener("touchmove",function(e){var t={x:e.touches[0].clientX,y:e.touches[0].clientY};n({x:t.x-r.anchor.x,y:t.y-r.anchor.y}),r.anchor=t}),t.addEventListener("touchend",function(e){r.anchor=null}),t.addEventListener("touchcancel",function(e){r.anchor=null})};n(201),n(179);function R(e){return(R="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function M(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function z(e){return(z=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function B(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function T(e,t){return(T=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}n.d(t,"default",function(){return Y});var q=521,G=.4,I=.1,F=.013,X=new r.m,Y=function(e){function t(e){var n,o,i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),o=this,(n=!(i=z(t).call(this,e))||"object"!==R(i)&&"function"!=typeof i?B(o):i).container=L.a.createRef(),n.animate=n.animate.bind(B(n)),n.scene=new r.j,n.composition=new x(n.scene),n.composition.setBackgroundColor(q),n}var n,o,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&T(e,t)}(t,L.a.Component),n=t,(o=[{key:"componentDidMount",value:function(){var e=this,t=this.container.current.offsetHeight;this.webGLRenderer=new r.q,this.webGLRenderer.autoClear=!1,this.webGLRenderer.setClearColor(0,0),this.webGLRenderer.setSize(t,t),this.webGLRenderer.setPixelRatio(window.devicePixelRatio),this.container.current.appendChild(this.webGLRenderer.domElement);var n=this.webGLRenderer.getDrawingBufferSize();this.composition.setSize(n.width,n.height),this.logo=new r.e(new r.i(G,I),new r.f({transparent:!0,map:X.load("https://markwinton.github.io/activity-card-assets/powered-by-strava.png")})),this.logo.position.x=.5-G/2,this.logo.position.y=I/2-.5-F,this.composition.addObject(this.logo),this.touch=new D(this.container.current,function(t){e.scene.rotation.y+=.002*t.x}),this.visualization=new P(this.props.activities,this.scene),this.composition.fitBoundingBox(this.visualization.boundingBox),this.animate()}},{key:"render",value:function(){return L.a.createElement("div",{className:"card noselect",ref:this.container})}},{key:"animate",value:function(){requestAnimationFrame(this.animate),this.composition.render(this.webGLRenderer)}},{key:"exportImage",value:function(e,t,n){var o=new r.q;o.autoClear=!1,o.setClearColor(0,0),o.setSize(e,t);var i=new x(this.scene);i.setSize(e,t),i.fitBoundingBox(this.visualization.boundingBox),i.setBackgroundColor(q),i.addObject(this.logo.clone()),i.render(o),o.domElement.toBlob(function(e){var t=URL.createObjectURL(e);n(t),URL.revokeObjectURL(t)})}}])&&M(n.prototype,o),i&&M(n,i),t}()}}]);